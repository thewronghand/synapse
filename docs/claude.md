# Claude 협업 규칙

이 문서는 Claude Code와 함께 Synapse 프로젝트를 작업할 때 지켜야 할 규칙을 정의합니다.

---

## 1. Git 커밋/PR 규칙

### 1.1 Claude 관련 문구 금지

- 커밋 메시지, PR 설명 등에 Claude 관련 문구를 **절대 포함하지 않는다**
- "🤖 Generated with Claude Code", "Co-Authored-By: Claude" 등 모두 제외

### 1.2 커밋 메시지 형식

- **한 줄 커밋 메시지만 작성**
- 부가 설명 라인을 추가하지 않는다
- 간결하고 명확하게 작성

**좋은 예:**

```
feat: Novel 에디터 통합 및 AI 자동완성 설정
```

**나쁜 예:**

```
feat: Novel 에디터 통합

- Novel 라이브러리 설치
- AI 자동완성 API 연동
- 기본 에디터 컴포넌트 구현

🤖 Generated with Claude Code
```

### 1.3 Git 작업 전 승인 필수

커밋, 푸쉬, 머지 등 저장소에 영향을 미치는 작업은 **반드시 사용자 승인 필요**

**절차:**

1. 작업 완료 후: "커밋할까요?"
2. 사용자 승인 받음
3. 커밋 실행
4. "푸쉬할까요?"
5. 사용자 승인 받음
6. 푸쉬 실행

---

## 2. 브랜치 전략

### 2.1 브랜치 구조

- **`main`**: 배포용 브랜치 (프로덕션)
- **`dev`**: 작업용 기본 브랜치
- **`feature/*`**: 기능 개발 브랜치 (dev에서 분기)

### 2.2 작업 흐름

1. **작업 시작 전**: 항상 현재 브랜치 확인

   ```bash
   git branch --show-current
   ```

2. **dev에서 작업 브랜치 생성**

   ```bash
   git checkout dev
   git pull origin dev
   git checkout -b <branch-name>
   ```

3. **브랜치 네이밍 컨벤션**

   - `feat/기능명`: 새 기능 개발
   - `fix/버그명`: 버그 수정
   - `dep/라이브러리명`: 의존성 추가/업데이트
   - `refactor/대상`: 리팩토링
   - `docs/내용`: 문서 작업
   - `deploy/내용`: 배포 관련 작업
   - `design/`: 디자인 관련 작업 (UI 스타일링)
   - `style/`: 코드 스타일 관련 작업
   - `chore/`: 그 외 기타 작업

4. **작업 완료 후 dev로 머지**
   ```bash
   git checkout dev
   git merge <branch-name>
   git branch -d <branch-name>
   ```

### 2.3 PR (Pull Request) 워크플로우

**GitHub PR 방식 사용 (권장)**

작업 브랜치를 dev로 머지할 때는 **GitHub PR**을 통해 진행합니다.

**절차:**

1. **작업 브랜치 push**
   ```bash
   git push -u origin <branch-name>
   ```

2. **GitHub PR 생성 (CLI)**
   ```bash
   gh pr create --base dev --head <branch-name> --title "PR 제목" --body "PR 설명"
   ```

   - CLI로 PR을 생성하면 GitHub 웹사이트에도 PR이 생깁니다
   - PR 링크가 출력되면 브라우저에서 확인 가능

3. **GitHub에서 PR 머지**
   - GitHub 웹사이트에서 PR 확인
   - 코드 리뷰 (필요시)
   - "Merge pull request" 버튼으로 머지
   - 또는 CLI로 머지: `gh pr merge <pr-number> --merge`

4. **로컬 브랜치 업데이트**
   ```bash
   git checkout dev
   git pull origin dev
   ```

**로컬 머지 vs GitHub PR:**

- **로컬 머지** (`git merge`): GitHub에 PR 기록이 남지 않음
- **GitHub PR** (`gh pr create`): GitHub에 PR 기록이 남고, 웹에서 코드 리뷰 가능 ✅ 권장

### 2.4 예시

**현재 할 일**: Next.js 프로젝트 초기 세팅

- 브랜치 확인
- `dep/nextjs-setup` 브랜치 생성
- 작업 후 dev로 PR 생성 및 머지

---

## 3. 코드 작성 규칙

### 3.1 질문과 구현의 분리

사용자가 질문하면:

- ❌ 바로 코드 생성/수정 금지
- ✅ 먼저 의견 나누기
- ✅ 사용자가 **"해줘"** 라고 명시적으로 요청할 때만 코드 수정

**예시:**

```
사용자: "Novel 에디터에 커스텀 플러그인 추가하면 어떨까?"

❌ 나쁜 응답:
(바로 코드 작성 시작)

✅ 좋은 응답:
"커스텀 플러그인 추가는 좋은 아이디어입니다.
다만 이런 점들을 고려해야 합니다:
1. Novel의 확장 API 사용 방법
2. 플러그인 관리 구조
3. ...

어떤 방향으로 진행할까요?"

(사용자가 "해줘"라고 하면 그때 구현)
```

### 3.2 의견 개진

- 사용자의 의견을 무시하지 않되
- 기술적으로 문제가 있거나 더 나은 방법이 있으면 **적극적으로 의견 제시**
- 장단점을 명확히 설명

**예시:**

```
사용자: "모든 문서를 한 번에 메모리에 로드하면 어떨까?"

응답:
"문서를 전부 메모리에 로드하는 방식은 다음과 같은 문제가 있습니다:
- 문서가 많아지면 메모리 부족
- 초기 로딩 시간 증가
- 불필요한 데이터 로드

대신 이런 방식을 추천합니다:
- 페이지네이션 또는 무한 스크롤
- 현재 보는 문서 + 링크된 문서만 로드
- 검색 시 필요한 것만 fetch

어떻게 하시겠어요?"
```

---

## 4. 기타 규칙

### 4.1 주요 결정 사항은 문서화

- 중요한 기술적 결정은 `docs/` 폴더에 기록
- 나중에 참고할 수 있도록

### 4.2 TODO 관리

- TodoWrite 도구를 적극 활용
- 진행 상황을 명확히 추적

### 4.3 테스트

- 가능한 경우 테스트 작성 권장
- 사용자에게 테스트 필요성 제안

---

## 요약 체크리스트

작업 시작 전:

- [ ] 현재 브랜치 확인
- [ ] dev에서 작업 브랜치 생성
- [ ] 사용자와 구현 방향 논의

작업 중:

- [ ] 질문에는 의견으로 답하기 (바로 코드 작성 X)
- [ ] 더 나은 방법 있으면 제안하기

작업 후:

- [ ] 사용자에게 커밋 승인 요청
- [ ] 한 줄 커밋 메시지 (Claude 문구 제외)
- [ ] 사용자에게 푸쉬 승인 요청
- [ ] GitHub PR 생성 (`gh pr create`)
- [ ] PR 링크 공유 후 사용자가 GitHub에서 머지

---

**이 문서는 프로젝트 진행 중 필요에 따라 업데이트됩니다.**
